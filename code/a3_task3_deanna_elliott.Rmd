---
title: "Task 3"
author: "Deanna Elliott"
date: "10/23/2021"
output: html_document
---

```{r setup, include=TRUE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
options(digits = 2)

#attach packages

library(tidyverse)
library(here)
library(janitor)
library(kableExtra)
```

## Overview ##

This code wrangles and visualizes data of red and purple urchins sizes observed at 5 sites along the Santa Barbara coast.

**Data Citation:** Reed, D. 2020. SBC LTER: Reef: Long-term experiment: Kelp removal: Urchin size frequency distribution ver 20. Environmental Data Initiative. https://doi.org/10.6073/pasta/5a1e9ef03aa47bd2225c0bb98a02a63b. 

## Read In Data ##

urchins.csv contains observations about size frequencies of red and purple sea urchins in the Santa Barbara Coastal LTER

```{r}

urchins <- read_csv(here("data", "urchins.csv")) %>% 
  clean_names()
```

## Data Visualization ##

```{r histogram}

ggplot(data = urchins,
       aes(x = size, fill = common_name)) +
           scale_fill_manual(values = c("darkorchid3", "firebrick3"),
                             name = "Species") +
  xlim(0, 15) +
  geom_histogram(bins = 10) +
  facet_wrap(~ common_name) +
  labs(x = "Diameter (cm)",
           y = "Count")
```

**Figure 1. Urchin count by size and species.** This histogram shows observations of the number and diameter in cm of purple and red sea urchins (*Strongylocentrotus purpuratus* and *Mesocentrotus franciscanus*) from 5 sites along the Santa Barbara Coastal LTER.


```{r stats table}

urchin_summary <- urchins %>% 
  group_by(common_name) %>% 
  summarize(mean_size_cm = mean(size, na.rm = TRUE), 
            sd_size_cm = sd(size, na.rm = TRUE),
            median_size_cm = median(size, na.rm = TRUE),
            sample_size = n())

urchin_summary %>% 
  kbl(col.names = c("Species Common Name", "Mean Size (cm)", "Standard Deviation (cm)",
                    "Median Size (cm)", "Sample Size (n)"),
      caption = "<b>Table 1. Summary statistics for urchin sizes.</b> Mean, standard deviation, and median in cm and sample size of purple and red sea  urchins (<i>Strongylocentrotus purpuratus</i> and <i>Mesocentrotus franciscanus</i>) observed at Santa Barbara Coastal LTER.") %>% 
  kable_classic()
```

### Takeaways ###

Based on the histogram and the summary statistics, red urchins are, on average, approximately 2.5 cm--or 35%--larger than purple urchins. Red urchins also have a larger size range compared to purple, as their distribution in the histogram is more widely spread. The central tendencies of each species are expressed approximately equally by the mean and median (4.5 cm and 4.5 cm for purple; 6.8 cm and 7.0 cm for red).

```{r filter purple}

```

```{r purple table, include = FALSE}

```

```{r purple graph}

```

GRAPH QUESTIONS

## End Task ##